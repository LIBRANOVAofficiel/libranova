<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>LIBRANOVA - Pour un nouveau monde</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
</head>
<body>
  <header class="hero-banner">
    <div class="overlay">
      <h1>LIBRANOVA</h1>
      <p class="slogan">
        Pour un nouveau monde, s'unir pour partager, s'éveiller pour changer.<br />
        Ensemble, bâtissons un monde libéré des chaînes de l'injustice.
      </p>
    </div>
  </header>

  <nav>
    <ul>
      <li><a href="#presentation">Présentation</a></li>
      <li><a href="#manifeste">Manifeste</a></li>
      <li><a href="#chants">Chants</a></li>
      <li><a href="#contact">Contact</a></li>
      <li><a href="#rejoindre">Rejoindre</a></li>
      <li><a href="#commentaires">Commentaires</a></li>
    </ul>
  </nav>

  <!-- Contenu des sections (non modifié) -->
  <!-- ... tes sections ici ... -->

  <!-- Section compteur -->
  <section id="compteur" style="text-align: center; margin-top: 2rem;">
    <h2>Visiteurs du site</h2>
    <div id="visitor-count" style="font-size: 1.5rem; margin-top: 1rem;">
      Chargement du compteur...
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div style="text-align: center;">
      <img src="images/licence-libranova.png" alt="Licence CC" style="max-width: 100%; height: auto; margin-top: 1rem; border-radius: 10px;">
    </div>
    <p>© 2025 LIBRANOVA | Licence CC BY-NC-ND 4.0</p>
  </footer>

  <!-- Script JS placé en bas de page (important) -->
  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

    const SUPABASE_URL = 'https://sbvczmythudfntzgofjw.supabase.co'
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNidmN6bXl0aHVkZm50emdvZmp3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc4NDk0NjAsImV4cCI6MjA2MzQyNTQ2MH0.chVFdhJFUU1JBsuiDVENggcDlrxq3gEDNK7TEa5aub8'

    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY)

    async function logVisit() {
      const { error } = await supabase.from('VISITS').insert({})
      if (error) {
        console.error('Erreur enregistrement de la visite :', error.message)
      }
    }

    async function getVisitCount() {
      const { data, error } = await supabase.from('VISITS').select('id')
      if (error) {
        console.error('Erreur récupération compteur :', error.message)
        return null
      }
      return data.length
    }

    document.addEventListener('DOMContentLoaded', async () => {
      await logVisit()
      const count = await getVisitCount()
      const counterDisplay = document.getElementById('visitor-count')
      if (counterDisplay && count !== null) {
        counterDisplay.textContent = `Nombre de visiteurs : ${count}`
      } else {
        counterDisplay.textContent = `Compteur indisponible.`
      }
    })
  </script>
</body>
</html>
