<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>LIBRANOVA - Pour un nouveau monde</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
</head>
<body>
  <header class="hero-banner">
    <div class="overlay">
      <h1>LIBRANOVA</h1>
      <p class="slogan">
        Pour un nouveau monde, s'unir pour partager, s'éveiller pour changer.<br />
        Ensemble, bâtissons un monde libéré des chaînes de l'injustice.
      </p>
    </div>
  </header>

  <nav>
    <ul>
      <li><a href="#presentation">Présentation</a></li>
      <li><a href="#manifeste">Manifeste</a></li>
      <li><a href="#chants">Chants</a></li>
      <li><a href="#contact">Contact</a></li>
      <li><a href="#rejoindre">Rejoindre</a></li>
      <li><a href="#commentaires">Commentaires</a></li>
    </ul>
  </nav>

  <section id="presentation">
    <img src="images/banniere-utopie-travail-vie.png" alt="Travail vs Vie humaine" class="banniere-section" />
    <h2>Présentation</h2>
    <p>
      LIBRANOVA est un projet de transformation globale, une vision pour un monde libéré de l'argent, où l’humanité s’unit dans le respect, la solidarité et la conscience collective.
      <br><br>
      C’est l’appel à bâtir ensemble une civilisation équitable, sans frontières économiques, où chaque être humain a accès à un logement, à la nourriture, à la santé, au savoir, à la paix et à la dignité.
      <br><br>
      LIBRANOVA refuse le règne de la rareté imposée. Il propose un monde d’abondance partagée, en harmonie avec la planète, libérant le potentiel humain des chaînes du profit.
    </p>
  </section>

  <section id="manifeste">
    <img src="images/banniere-utopie-pauvreté-fin de la misére.png" alt="Pauvreté vs Fin de la misère" class="banniere-section" />
    <h2>Le Manifeste</h2>
    <p>Téléchargez le manifeste complet :</p>
    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
      <a href="Manifeste-LIBRANOVA.pdf" class="button" download>Télécharger le PDF</a>
      <a href="Manifeste-LIBRANOVA.pdf" class="button" target="_blank">Lire en ligne</a>
    </div>
  </section>

  <section id="chants">
    <img src="images/banniere-utopie-noneveil-eveil.png" alt="Éveil du monde" class="banniere-section" />
    <h3 style="text-align: center;">Chant LIBRANOVA</h3>
    <div style="display: flex; justify-content: space-around; flex-wrap: wrap; gap: 2rem; margin-top: 1rem;">
      <div style="text-align: center;">
        <p><strong>Version féminine</strong><br>Voix douce et émotive, portée par l’espoir.</p>
        <a href="audio/Le chant de l'âme feminin.mp3" class="button" target="_blank">Écouter</a><br><br>
        <a href="audio/Le chant de l'âme feminin.mp3" class="button" download>Télécharger</a>
      </div>
      <div style="text-align: center;">
        <p><strong>Version masculine</strong><br>Voix profonde et engagée.</p>
        <a href="audio/Le chant de l'âme masculin.mp3" class="button" target="_blank">Écouter</a><br><br>
        <a href="audio/Le chant de l'âme masculin.mp3" class="button" download>Télécharger</a>
      </div>
    </div>
    <p style="margin-top: 1rem; font-size: 0.9rem; text-align: center; color: #555;">
      Ces chants sont protégés par la licence CC BY-NC-ND 4.0. Partage libre sans usage commercial.
    </p>
  </section>

  <section id="contact">
    <img src="images/banniere-utopie-guerre-paix.png" alt="Guerre vs Paix" class="banniere-section" />
    <h2>Contact & Réseaux</h2>
    <p>Email : <a href="mailto:libranova.contact@gmail.com">libranova.contact@gmail.com</a></p>
    <p>YouTube : <a href="https://www.youtube.com/@LeporteurdeLIBRANOVA" target="_blank">@LeporteurdeLIBRANOVA</a></p>
    <p>Instagram : <a href="https://www.instagram.com/libranova_officiel" target="_blank">@libranova_officiel</a></p>
  </section>

  <section id="rejoindre">
    <img src="images/banniere-utoipie--rejoindre-libranova.png" alt="Rejoindre LIBRANOVA" class="banniere-section" />
    <h2>Rejoindre le Mouvement LIBRANOVA</h2>
    <p>
      LIBRANOVA est un appel. Un rêve commun. Une révolution de l’âme et de la raison.
      Si cette vision résonne en vous, alors vous en êtes déjà une partie. Voici comment vous pouvez agir :
    </p>
    <ul>
      <li><strong>Partager le Manifeste</strong> dans votre langue, sur vos réseaux, autour de vous.</li>
      <li><strong>Faire connaître le Chant de l'Âme</strong>, outil émotionnel puissant pour éveiller les consciences.</li>
      <li><strong>Traduire, diffuser, adapter</strong> le contenu dans d'autres langues ou formats (vidéos, affiches, textes).</li>
      <li><strong>Créer des cercles LIBRANOVA</strong> dans vos villes, écoles, espaces citoyens.</li>
      <li><strong>Nous contacter</strong> pour toute idée, collaboration ou question : <a href="mailto:libranova.contact@gmail.com">libranova.contact@gmail.com</a></li>
      <li><strong>S’éveiller et éveiller</strong> par l’exemple : en vivant dès maintenant les valeurs de LIBRANOVA.</li>
    </ul>
    <div style="text-align: center; margin-top: 2rem;">
      <p><strong>Vous croyez en ce monde nouveau ?</strong></p>
      <a href="https://www.mesopinions.com/petition/social/libranova-monde-argent-fonde-humain-planete/242752" class="button" target="_blank" style="background-color: #007bff;">
        Signer la pétition LIBRANOVA
      </a>
    </div>
   <div class="like-container" style="margin-top: 20px;">
      <button class="like-button" id="like-btn">❤️ J’aime</button>
      <span id="like-count">Chargement...</span>
    </div>
  </section>

  <section id="commentaires">
    <img src="images/banniere-utopie-avis-libranova.png" alt="Partager votre avis" class="banniere-section">
    <h2>Partagez votre avis</h2>
    <div class="section-content">
      <p>Vos réflexions, ressentis et idées sont précieux. Merci de contribuer à faire grandir LIBRANOVA.</p>
      <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSf7il1KsWvoiFwUbfNZjNUewlI_PO68PD1AM0wEEh4MrJmMkw/viewform?embedded=true" width="100%" height="1400" frameborder="0" marginheight="0" marginwidth="0">Chargement…</iframe>
    </div>
  </section>

  <section class="banniere-section compteur-section" style="position: relative;">
  <div class="banniere-texte">
    <h2>Un monde uni commence par une vision commune</h2>
    <p class="citation">Ce n’est pas l’uniformité qui unit les peuples, mais la reconnaissance de ce qui les relie.</p>
  </div>
    <div id="visitor-count" style="font-size: 1.5rem; margin-top: 1.5rem; color: white;">
      Chargement du compteur...</div>
</section>

  <!-- Footer -->
  <footer>
    <div style="text-align: center;">
      <img src="images/licence-libranova.png" alt="Licence CC" style="max-width: 100%; height: auto; margin-top: 1rem; border-radius: 10px;">
    </div>
    <p>© 2025 LIBRANOVA | Licence CC BY-NC-ND 4.0</p>
  </footer>

  <!-- Script JS placé en bas de page (important) -->
 <!-- Script compteur visiteurs (module) -->
  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

    const SUPABASE_URL = 'https://sbvczmythudfntzgofjw.supabase.co'
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNidmN6bXl0aHVkZm50emdvZmp3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc4NDk0NjAsImV4cCI6MjA2MzQyNTQ2MH0.chVFdhJFUU1JBsuiDVENggcDlrxq3gEDNK7TEa5aub8'

    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY)
   async function logVisit() {
  const visitorId = getOrCreateVisitorId();

  const { data: existing, error: checkError } = await supabase
    .from('VISITS')
    .select('*')
    .eq('visitor_id', visitorId);

  if (checkError) {
    console.error('Erreur de vérification du visiteur :', checkError.message);
    return;
  }

  if (existing.length === 0) {
    const { error: insertError } = await supabase
      .from('VISITS')
      .insert([{ visitor_id: visitorId }]);

    if (insertError) {
      console.error('Erreur enregistrement de la visite :', insertError.message);
    }
  } else {
    console.log('Visite déjà enregistrée');
  }
}

    async function getVisitCount() {
      const { data, error } = await supabase.from('VISITS').select('id')
      if (error) {
        console.error('Erreur récupération compteur :', error.message)
        return null
      }
      return data.length
    }

    document.addEventListener('DOMContentLoaded', async () => {
      await logVisit()
      const count = await getVisitCount()
      const counterDisplay = document.getElementById('visitor-count')
      if (counterDisplay && count !== null) {
        counterDisplay.textContent = `Nombre de visiteurs : ${count}`
      } else {
        counterDisplay.textContent = `Compteur indisponible.`
      }
    })
  </script>

  <!-- Script bouton Like -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script>
    const SUPABASE_URL = 'https://sbvczmythudfntzgofjw.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNidmN6bXl0aHVkZm50emdvZmp3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc4NDk0NjAsImV4cCI6MjA2MzQyNTQ2MH0.chVFdhJFUU1JBsuiDVENggcDlrxq3gEDNK7TEa5aub8';
    const TABLE_NAME = 'likes';

    const supabaseLike = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    function getOrCreateVisitorId() {
      let id = localStorage.getItem('visitor_id');
      if (!id) {
        id = (Math.random().toString(36).substring(2)) + Date.now().toString(36);
        localStorage.setItem('visitor_id', id);
      }
      return id;
    }

    async function fetchLikeCount() {
      const { count, error } = await supabaseLike
        .from(TABLE_NAME)
        .select('*', { count: 'exact', head: true });

      if (!error) {
        document.getElementById('like-count').textContent = `${count} j'aime`;
      } else {
        console.error("Erreur chargement likes :", error.message);
      }
    }

    async function handleLike() {
  const visitorId = getOrCreateVisitorId();
  console.log("visitorId =", visitorId);

  // Vérifier existence d'un like
  const { data: existing, error: selectError } = await supabaseLike
    .from('likes')
    .select('*')
    .eq('ip_hash', visitorId);

  if (selectError) {
    console.error("Erreur de vérification du like :", selectError.message);
    return;
  }

  if (existing && existing.length > 0) {
    console.log("Déjà liké");
    return;
  }

  // Enregistrer le like
  const { error: insertError } = await supabaseLike
    .from('likes')
    .insert([{ ip_hash: visitorId }]);  // << CLÉ : tableau + nom de champ bien orthographié

  if (!insertError) {
    document.querySelector('.like-button').classList.add('clicked');
    fetchLikeCount();
  } else {
    console.error("Erreur d'enregistrement du like :", insertError.message);
  }
}
    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("like-btn").addEventListener("click", handleLike);
      fetchLikeCount();
    });
  </script>
</body>
</html>
